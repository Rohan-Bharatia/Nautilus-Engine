cmake_minimum_required(VERSION 3.12)

project(imgui LANGUAGES CXX)
if(APPLE)
    enable_language(OBJCXX)
endif()

file(GLOB ImGui_SRC
    ${CMAKE_CURRENT_LIST_DIR}/imgui/*.cpp
    ${CMAKE_CURRENT_LIST_DIR}/imguizmo/*.cpp
)

if(WIN32)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_win32.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_dx9.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_dx10.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_dx11.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_dx12.cpp)
elseif(APPLE)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_osx.mm)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_metal.mm)
elseif(ANDROID)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_android.cpp)
elseif(EMSCRIPTEN)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_wgpu.cpp)
endif()

find_package(OpenGL QUIET)
if(${OpenGL_FOUND})
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_opengl2.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_opengl3.cpp)
endif()
find_package(Vulkan QUIET)
if(${Vulkan_FOUND})
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_vulkan.cpp)
endif()

if(IMGUI_BACKEND_GLFW3)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_glfw.cpp)
endif()
if(IMGUI_BACKEND_GLUT)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_glut.cpp)
endif()
if(IMGUI_BACKEND_SDL2)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_sdl2.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_sdlrenderer2.cpp)
endif()
if(IMGUI_BACKEND_SDL3)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_sdl3.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_sdlrenderer3.cpp)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_sdlgpu3.cpp)
endif()
if(IMGUI_BACKEND_ALLEGRO5)
    list(APPEND ImGui_SRC ${CMAKE_CURRENT_LIST_DIR}/imgui/backends/imgui_impl_allegro5.cpp)
endif()

add_library(imgui ${ImGui_SRC})

if(WIN32)
    target_link_libraries(imgui PUBLIC d3d9 d3d11 d3d12 dxgi)
elseif(APPLE)
    target_link_libraries(imgui PUBLIC "-framework Cocoa" "-framework IOKit" "-framework QuartzCore")
elseif(ANDROID)
    target_link_libraries(imgui PUBLIC android log)
elseif(EMSCRIPTEN)
    target_link_libraries(imgui PUBLIC wgpu)
endif()

if(${OpenGL_FOUND})
    target_link_libraries(imgui PUBLIC OpenGL::GL)
endif()
if(${Vulkan_FOUND})
    target_link_libraries(imgui PUBLIC Vulkan::Vulkan)
endif()

if(IMGUI_BACKEND_GLFW3)
    target_link_libraries(imgui PUBLIC glfw)
endif()
if(IMGUI_BACKEND_GLUT)
    target_link_libraries(imgui PUBLIC glut)
endif()
if(IMGUI_BACKEND_SDL2)
    target_link_libraries(imgui PUBLIC SDL2)
endif()
if(IMGUI_BACKEND_SDL3)
    target_link_libraries(imgui PUBLIC SDL3)
endif()
if(IMGUI_BACKEND_ALLEGRO5)
    target_link_libraries(imgui PUBLIC allegro5)
endif()

target_include_directories(imgui PUBLIC
    ${CMAKE_CURRENT_LIST_DIR}/imgui
    ${CMAKE_CURRENT_LIST_DIR}/imgui/backends
    ${CMAKE_CURRENT_LIST_DIR}/imguizmo
)
